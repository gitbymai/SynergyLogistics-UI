<div class="card shadow-sm my-4">
  <div class="card-header bg-primary text-white">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex align-items-center gap-3">
        <h4 class="mb-0">Job Details</h4>
        <span class="badge badge-code">{{ job?.jobCode }}</span>
      </div>
      <div class="d-flex gap-2">
        <button routerLink="/jobs/list" class="btn btn-light-custom btn-sm">
          <i class="cil-arrow-left me-1"></i>
          <span>Back to List</span>
        </button>
        <button class="btn btn-light-custom btn-sm" (click)="printJobDetails()">
          <i class="cil-print me-1"></i>
          <span>Print</span>
        </button>
      </div>
    </div>
  </div>

  <div class="card-body job-details-body">
    <div class="accordion accordion-custom" id="jobDetailsAccordion">
      
      <!-- ======================= 1. JOB INFORMATION ======================== -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingJobInfo">
          <button class="accordion-button" 
                  [class.collapsed]="!isSectionOpen('jobInfo')"
                  type="button" 
                  (click)="toggleSection('jobInfo')"
                  [attr.aria-expanded]="isSectionOpen('jobInfo')">
            <i class="cil-briefcase me-2"></i>
            Job Information
          </button>
        </h2>
        <div id="collapseJobInfo" 
             class="accordion-collapse" 
             [class.show]="isSectionOpen('jobInfo')">
          <div class="accordion-body">
            <!-- ... existing content ... -->
            <div class="detail-section">
              <div class="row g-4">
                <div class="col-md-8">
                  <div class="detail-item">
                    <label class="detail-label">
                      <i class="cil-user"></i> Client
                    </label>
                    <div class="detail-value">{{ job?.customerName || '-' }}</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">
                      <i class="cil-info"></i> Status
                    </label>
                    <div class="detail-value">
                      <span [class]="'badge status-badge ' + getStatusBadgeClass(job?.jobStatusName || '')">
                        {{ job?.jobStatusName || 'Pending' }}
                      </span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="detail-section">
              <div class="row g-4">
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">
                      <i class="cil-swap-horizontal"></i> Transaction Type
                    </label>
                    <div class="detail-value">{{ job?.transactionTypeName || '-' }}</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">
                      <i class="cil-tags"></i> Incoterms
                    </label>
                    <div class="detail-value">{{ job?.incotermsName || '-' }}</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">
                      <i class="cil-credit-card"></i> Payment Type
                    </label>
                    <div class="detail-value">{{ job?.paymentTypeName || '-' }}</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="detail-section">
              <div class="row g-4">
                <div class="col-md-6">
                  <div class="detail-item highlight-box">
                    <label class="detail-label">
                      <i class="cil-dollar"></i> Amount
                    </label>
                    <div class="detail-value-large">₱{{ job?.amount | number:'1.2-2' }}</div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="detail-item">
                    <label class="detail-label">
                      <i class="cil-calendar"></i> Created Date
                    </label>
                    <div class="detail-value">{{ job?.createdDate | date:'MMM dd, yyyy' }}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ======================= 2. CARGO & ROUTING DETAILS ======================== -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingCargo">
          <button class="accordion-button" 
                  [class.collapsed]="!isSectionOpen('cargo')"
                  type="button"
                  (click)="toggleSection('cargo')"
                  [attr.aria-expanded]="isSectionOpen('cargo')">
            <i class="cil-layers me-2"></i>
            Cargo & Routing Details
          </button>
        </h2>
        <div id="collapseCargo" 
             class="accordion-collapse" 
             [class.show]="isSectionOpen('cargo')">
          <div class="accordion-body">
            <!-- ... existing cargo content ... -->
            <div class="detail-section">
              <h6 class="section-subtitle">
                <i class="cil-inbox"></i> Shipment Information
              </h6>
              <div class="row g-4">
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">Commodity</label>
                    <div class="detail-value">{{ job?.commodity || '-' }}</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">
                      <i class="cil-calendar"></i> Cut-off / LCT
                    </label>
                    <div class="detail-value">{{ job?.cutoff | date:'MMM dd, yyyy' }}</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">Carrier</label>
                    <div class="detail-value">{{ job?.carrier || '-' }}</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="detail-section">
              <h6 class="section-subtitle">
                <i class="cil-location-pin"></i> Routing Information
              </h6>
              <div class="row g-4">
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">Origin</label>
                    <div class="detail-value">{{ job?.origin || '-' }}</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">Destination</label>
                    <div class="detail-value">{{ job?.destination || '-' }}</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">Port / CFS</label>
                    <div class="detail-value">{{ job?.portCfs || '-' }}</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="detail-section">
              <h6 class="section-subtitle">
                <i class="cil-chart"></i> Measurements
              </h6>
              <div class="row g-4">
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">Gross Weight</label>
                    <div class="detail-value">{{ job?.grossWeight || '-' }} kg</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">Volume (CBM)</label>
                    <div class="detail-value">{{ job?.volume || '-' }} m³</div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="detail-item">
                    <label class="detail-label">Number of Packages</label>
                    <div class="detail-value">{{ job?.numberOfPackages || '-' }}</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ======================= 3. FREIGHT DETAILS ======================== -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingFreight">
          <button class="accordion-button" 
                  [class.collapsed]="!isSectionOpen('freight')"
                  type="button"
                  (click)="toggleSection('freight')"
                  [attr.aria-expanded]="isSectionOpen('freight')">
            <i class="cil-airplane-mode me-2"></i>
            Freight Details
          </button>
        </h2>
        <div id="collapseFreight" 
             class="accordion-collapse" 
             [class.show]="isSectionOpen('freight')">
          <div class="accordion-body">
            <!-- ... existing freight content ... -->
            <div *ngIf="isSeaFreight()" class="freight-section">
              <div class="freight-type-badge">
                <i class="cil-boat"></i> Sea Freight
              </div>

              <div class="detail-section">
                <h6 class="section-subtitle">Bill of Lading References</h6>
                <div class="row g-4">
                  <div class="col-md-6">
                    <div class="detail-item">
                      <label class="detail-label">MBL Reference</label>
                      <div class="detail-value">{{ job?.mbl || '-' }}</div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="detail-item">
                      <label class="detail-label">HBL Reference</label>
                      <div class="detail-value">{{ job?.hbl || '-' }}</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="detail-section">
                <h6 class="section-subtitle">Vessel & Container Information</h6>
                <div class="row g-4">
                  <div class="col-md-6">
                    <div class="detail-item">
                      <label class="detail-label">Vessel</label>
                      <div class="detail-value">{{ job?.vessel || '-' }}</div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="detail-item">
                      <label class="detail-label">Container Size</label>
                      <div class="detail-value">{{ job?.containerCount || '-' }}</div>
                    </div>
                  </div>
                  <div class="col-md-3">
                    <div class="detail-item">
                      <label class="detail-label">Container Count</label>
                      <div class="detail-value">{{ job?.containerCount || '-' }}</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="detail-section" *ngIf="job?.containerCount">
                <div class="detail-item">
                  <label class="detail-label">Container Numbers</label>
                  <div class="detail-value">{{ job?.containerCount }}</div>
                </div>
              </div>
            </div>

            <div *ngIf="isAirFreight()" class="freight-section">
              <div class="freight-type-badge">
                <i class="cil-airplane-mode"></i> Air Freight
              </div>

              <div class="detail-section">
                <h6 class="section-subtitle">Air Waybill References</h6>
                <div class="row g-4">
                  <div class="col-md-6">
                    <div class="detail-item">
                      <label class="detail-label">MAWB Reference</label>
                      <div class="detail-value">{{ job?.mawb || '-' }}</div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="detail-item">
                      <label class="detail-label">HAWB Reference</label>
                      <div class="detail-value">{{ job?.hawb || '-' }}</div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="detail-section">
                <h6 class="section-subtitle">Flight Information</h6>
                <div class="row g-4">
                  <div class="col-md-6">
                    <div class="detail-item">
                      <label class="detail-label">Flight No.</label>
                      <div class="detail-value">{{ job?.flightNo || '-' }}</div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="detail-item">
                      <label class="detail-label">Chargeable Weight</label>
                      <div class="detail-value">{{ job?.chargeableWeight || '-' }} kg</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ======================= 4. ADDITIONAL DETAILS ======================== -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingAdditional">
          <button class="accordion-button" 
                  [class.collapsed]="!isSectionOpen('additional')"
                  type="button"
                  (click)="toggleSection('additional')"
                  [attr.aria-expanded]="isSectionOpen('additional')">
            <i class="cil-notes me-2"></i>
            Additional Details
          </button>
        </h2>
        <div id="collapseAdditional" 
             class="accordion-collapse" 
             [class.show]="isSectionOpen('additional')">
          <div class="accordion-body">
            <!-- ... existing additional content ... -->
            <div class="detail-section">
              <div class="row g-4">
                <div class="col-md-6">
                  <div class="detail-item">
                    <label class="detail-label">
                      <i class="cil-people"></i> Agent
                    </label>
                    <div class="detail-value">{{ job?.agent || '-' }}</div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="detail-item">
                    <label class="detail-label">Booking No.</label>
                    <div class="detail-value">{{ job?.bookingNo || '-' }}</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="detail-section">
              <div class="detail-item">
                <label class="detail-label">
                  <i class="cil-notes"></i> Remarks
                </label>
                <div class="detail-value remarks-box">
                  {{ job?.remarks || 'No remarks' }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ======================= 5. CHARGES & DISBURSEMENTS ======================== -->
      <div class="accordion-item">
        <h2 class="accordion-header" id="headingCharges">
          <button class="accordion-button" 
                  [class.collapsed]="!isSectionOpen('charges')"
                  type="button"
                  (click)="toggleSection('charges')"
                  [attr.aria-expanded]="isSectionOpen('charges')">
            <i class="cil-dollar me-2"></i>
            Charges | Exepenses | Disbursements
          </button>
        </h2>
        <div id="collapseCharges" 
             class="accordion-collapse" 
             [class.show]="isSectionOpen('charges')">
          <div class="accordion-body">
            <app-job-charges [charges]="charges" [jobGuid] = "jobGuid"></app-job-charges>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>